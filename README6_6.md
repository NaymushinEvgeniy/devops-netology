# Домашнее задание к занятию "6.6. Troubleshooting"

### Задача 1
Список операций для остановки запроса пользователя:
1. Определим id (UUID) операции:

        db.currentOp(
           {
             "active" : true,
             "secs_running" : { "$gt" : 180 },
             "ns" : /^db1\./
           }
            )
Для операции берем значение opid в формате "shardName:opid on that shard>"

2. Выполним остановку запроса:

        db.killOp("shardName:opid on that shard>")

### Задача 2

В данном случае системы взаимодействия между сервисами, похоже, что в Redis используется active way способ удаления 
ключей с истекшим сроком. При масштабировании сервиса в базе становится много ключей, срок которых истекает в ту же 
секунду и в какой-то момент их количество становится более 25 процентов, и Redis начнет блокировать записи, дабы вернуть
это значение к границе ниже 25 процентов.

### Задача 3

Данная ошибка может быть связана с отправкой слишком большого запроса на сервер - в ГИС системе как раз могут 
использоваться работа с большими двоичными объектами. Для локализации проблемы может стать увеличение значения параметра 
max_allowed_packet. В связке с увелечением значения данного параметра так же можно предложить увеличить объем 
оперативной памяти на сервере.

### Задача 4

Серверу не хватает свободной памяти, запрошенную процессом Postmaster, дабы избежать проблем с ядром ОС принудительно \
завершает процесс.

Проблему можно разрешить следующими способами:
- увеличить размер оперативной памяти
- произвести тонкую настройку Postgresql сервера, используя конфигурационный файл для оптимальной 
настройки использования памяти сервером Postgresql.
- установить параметр Linux vm.overcommit_memory (например =2 в связке с параметром /proc/sys/vm/swappiness=1, если 
размер ОЗУ >= размеру БД)
- использовать Swap-память